function matrixcircle(M,label,tit,style)
%MATRIXCIRCLE - Plots circle representative for elements of a matrix

% Molecular Biology and Evolution Toolbox (MBEToolbox)
% Author: James Cai
% Email: jcai@tamu.edu
% Website: http://bioinformatics.org/mbetoolbox/
% 
% $LastChangedDate: 2013-01-05 12:04:29 -0600 (Sat, 05 Jan 2013) $
% $LastChangedRevision: 327 $
% $LastChangedBy: jcai $


% Example matrix - jttdcmut_matrix
jttdcmut_matrix=[
0.000000 0.531678 0.557967 0.827445 0.574478 0.556725 1.066681 1.740159 0.219970 0.361684 0.310007 0.369437 0.469395 0.138293 1.959599 3.887095 4.582565 0.084329 0.139492 2.924161
0.531678 0.000000 0.451095 0.154899 1.019843 3.021995 0.318483 1.359652 3.210671 0.239195 0.372261 6.529255 0.431045 0.065314 0.710489 1.001551 0.650282 1.257961 0.235601 0.171995
0.557967 0.451095 0.000000 5.549530 0.313311 0.768834 0.578115 0.773313 4.025778 0.491003 0.137289 2.529517 0.330720 0.073481 0.121804 5.057964 2.351311 0.027700 0.700693 0.164525
0.827445 0.154899 5.549530 0.000000 0.105625 0.521646 7.766557 1.272434 1.032342 0.115968 0.061486 0.282466 0.190001 0.032522 0.127164 0.589268 0.425159 0.057466 0.453952 0.315261
0.574478 1.019843 0.313311 0.105625 0.000000 0.091304 0.053907 0.546389 0.724998 0.150559 0.164593 0.049009 0.409202 0.678335 0.123653 2.155331 0.469823 1.104181 2.114852 0.621323
0.556725 3.021995 0.768834 0.521646 0.091304 0.000000 3.417706 0.231294 5.684080 0.078270 0.709004 2.966732 0.456901 0.045683 1.608126 0.548807 0.523825 0.172206 0.254745 0.179771
1.066681 0.318483 0.578115 7.766557 0.053907 3.417706 0.000000 1.115632 0.243768 0.111773 0.097485 1.731684 0.175084 0.043829 0.191994 0.312449 0.331584 0.114381 0.063452 0.465271
1.740159 1.359652 0.773313 1.272434 0.546389 0.231294 1.115632 0.000000 0.201696 0.053769 0.069492 0.269840 0.130379 0.050212 0.208081 1.874296 0.316862 0.544180 0.052500 0.470140
0.219970 3.210671 4.025778 1.032342 0.724998 5.684080 0.243768 0.201696 0.000000 0.181788 0.540571 0.525096 0.329660 0.453428 1.141961 0.743458 0.477355 0.128193 5.848400 0.121827
0.361684 0.239195 0.491003 0.115968 0.150559 0.078270 0.111773 0.053769 0.181788 0.000000 2.335139 0.202562 4.831666 0.777090 0.098580 0.405119 2.553806 0.134510 0.303445 9.533943
0.310007 0.372261 0.137289 0.061486 0.164593 0.709004 0.097485 0.069492 0.540571 2.335139 0.000000 0.146481 3.856906 2.500294 1.060504 0.592511 0.272514 0.530324 0.241094 1.761439
0.369437 6.529255 2.529517 0.282466 0.049009 2.966732 1.731684 0.269840 0.525096 0.202562 0.146481 0.000000 0.624581 0.024521 0.216345 0.474478 0.965641 0.089134 0.087904 0.124066
0.469395 0.431045 0.330720 0.190001 0.409202 0.456901 0.175084 0.130379 0.329660 4.831666 3.856906 0.624581 0.000000 0.436181 0.164215 0.285564 2.114728 0.201334 0.189870 3.038533
0.138293 0.065314 0.073481 0.032522 0.678335 0.045683 0.043829 0.050212 0.453428 0.777090 2.500294 0.024521 0.436181 0.000000 0.148483 0.943971 0.138904 0.537922 5.484236 0.593478
1.959599 0.710489 0.121804 0.127164 0.123653 1.608126 0.191994 0.208081 1.141961 0.098580 1.060504 0.216345 0.164215 0.148483 0.000000 2.788406 1.176961 0.069965 0.113850 0.211561
3.887095 1.001551 5.057964 0.589268 2.155331 0.548807 0.312449 1.874296 0.743458 0.405119 0.592511 0.474478 0.285564 0.943971 2.788406 0.000000 4.777647 0.310927 0.628608 0.408532
4.582565 0.650282 2.351311 0.425159 0.469823 0.523825 0.331584 0.316862 0.477355 2.553806 0.272514 0.965641 2.114728 0.138904 1.176961 4.777647 0.000000 0.080556 0.201094 1.143980
0.084329 1.257961 0.027700 0.057466 1.104181 0.172206 0.114381 0.544180 0.128193 0.134510 0.530324 0.089134 0.201334 0.537922 0.069965 0.310927 0.080556 0.000000 0.747889 0.239697
0.139492 0.235601 0.700693 0.453952 2.114852 0.254745 0.063452 0.052500 5.848400 0.303445 0.241094 0.087904 0.189870 5.484236 0.113850 0.628608 0.201094 0.747889 0.000000 0.165473
2.924161 0.171995 0.164525 0.315261 0.621323 0.179771 0.465271 0.470140 0.121827 9.533943 1.761439 0.124066 3.038533 0.593478 0.211561 0.408532 1.143980 0.239697 0.165473 0.000000
];

AA = {'A','R','N','D','C','Q','E','G','H','I','L','K','M','F','P','S','T','W','Y','V'};
DINU = {'AA','AC','AG','AT',...
        'CA','CC','CG','CT',...
        'GA','GC','GG','GT',...
        'TA','TC','TG','TT'};
if (nargin<4), style='.'; end
if (nargin<3), tit='Title'; end
if (nargin<2),
    tit='Title';
    label=AA;
end
if (nargin<1)
      tit='JTT';
      label=AA;
      M=jttdcmut_matrix;
end

[n,m] = size(M);
M=(M./sum(sum(triu(M)))).*min(n,m);
%M=(M./sum(M(:))).*min(n,m);

if ~(ishold), hold on; end
for i=1:n
for j=i:m
	if (M(i,j)~=0)
	    circle([i,j],M(i,j),500,style);
	end
end
end

set(gca,'YTick',1:n)
set(gca,'YLim',[0 n+1])
set(gca,'YTickLabel',char(label));
%set(gca,'YDir','reverse')
set(gca,'XTick',1:m)
set(gca,'XLim',[0 m+1])
set(gca,'XTickLabel',char(label));
title(tit);
grid;
%rotateticklabel(gca,90);
axis ij;             % OR set(gca,'YDir','reverse')

%x=axis;
%t=max(x(2),x(4));
%x(2)=t;
%x(4)=t;
%axis(x);
axis square;
box on;
hold off;



